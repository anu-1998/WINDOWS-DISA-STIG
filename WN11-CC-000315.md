# STIG Implementation & Vulnerability Remediation

## WN11-CC-000315 – Windows Installer Elevated Privileges Must Be Disabled

---

## 1. STIG Identification

- **STIG ID:** WN11-CC-000315  
- **Vuln-ID:** V-253411  
- **Rule-ID:** SV-253411r954020_rule  
- **Severity Category:** CAT I  
- **CCI:** CCI-001812  
- **Audit Name:** DISA Windows 11 STIG v1r6  
- **Plugin:** Windows  
- **Control ID:** 2f0a6d9d5b593afe3f1c8e77111d2b7eadf2a4a38b7a36f3923a7646aca60aa4  
- **Audit Status:** Deprecated (scheduled for future removal)

---

## 2. Overview

This document describes the detection, manual remediation, automation, and validation of STIG **WN11-CC-000315** on Windows 11 endpoints using **Tenable** for vulnerability scanning.

**Purpose:** Prevent standard users from installing software with elevated privileges via Windows Installer, which could lead to privilege escalation and system compromise.

> Detect → Fix → Verify → Revert → Automate → Verify

---

## 3. Detection (Tenable Scan)

- **Tool Used:** Tenable (Nessus / Tenable.io)  
- **Scan Template:** Windows / DISA STIG Compliance Scan  

**Initial Scan Result:**

- ❌ FAILED  
- **STIG ID:** WN11-CC-000315  
- **Severity:** High (CAT I)  
- **Finding:** Windows Installer is configured to allow installation with elevated privileges for standard users.


TENABLE REPORT:    

<img width="1494" height="806" alt="Screenshot 2026-02-04 140306" src="https://github.com/user-attachments/assets/22ac4dd9-06d6-4a60-a894-3e4970c99ef8" />


---

## 4. Research & Analysis

- Google search: `"WN11-CC-000315"`  
- Official STIG path and configuration: Computer Configuration → Administrative Templates → Windows Components → Windows Installer
- Required setting:  "Always install with elevated privileges" = Disabled


---

## 5. Manual Remediation

**Method:** Local Group Policy Editor (`gpedit.msc`)

**Steps:**

1. Open Local Group Policy Editor:
2. Navigate to: Computer Configuration → Administrative Templates → Windows Components → Windows Installer
3. Locate policy: `"Always install with elevated privileges"`  
4. Set policy to **Disabled**  
5. Apply changes and update Group Policy
6. Restart the system

---

## 6. Verification (Manual Fix)

- System restarted  
- Tenable scan rerun  

**Result:** ✅ PASSED  


TENABLE SCAN REPORT :  


<img width="1510" height="818" alt="Screenshot 2026-02-04 140333" src="https://github.com/user-attachments/assets/de748361-9669-49d6-a60c-d5039c1dda3c" />


- **STIG ID:** WN11-CC-000315
  

---

## 7. Reversion Test

- Reverted the policy to previous state (Enabled / Not Configured)  
- Restarted system  
- Tenable scan rerun  

**Result:** ❌ FAILED  

> Confirms Tenable detects vulnerability and validates remediation.

---

## 8. PowerShell Remediation

**Objective:** Automate WN11-CC-000315 remediation.

[power shell script](https://github.com/anu-1998/WINDOWS-DISA-STIG/blob/main/WN11-CC-000315.ps1)

---

## 9. Verification (PowerShell Fix)

- PowerShell script executed

- System restarted

- Tenable scan rerun

Result: ✅ PASSED

<img width="1514" height="412" alt="Screenshot 2026-02-04 153209" src="https://github.com/user-attachments/assets/ca274148-7f70-473a-b07f-5718febf60a3" />


STIG ID: WN11-CC-000315

---

## 10. Evidence

Initial Tenable failed scan

Manual remediation screenshot

Tenable passed scan (manual fix)

Reverted configuration & failed scan

PowerShell script execution output

Final Tenable passed scan

(All evidence stored in GitHub repo / lab documentation.)

---

## 11. Security Impact

#### Before Remediation:

  - Privilege escalation possible
  
 -  Malicious software could gain administrative rights
  
 - Endpoint compromise risk

#### After Remediation:

 -  Elevated install privileges blocked
  
 -  Attack surface reduced

Windows 11 aligned with DISA STIG baseline

---

## 12. Conclusion

STIG WN11-CC-000315 was successfully:

- Detected via Tenable

- Remediated manually

- Verified through scan

- Reverted to validate detection

- Automated using PowerShell

- Revalidated for compliance

#### The system is now securely configured, mitigating privilege escalation risks.




